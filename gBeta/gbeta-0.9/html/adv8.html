






<HTML>
<HEAD><TITLE>gbeta Advanced Issues:: More Versatile Control Structures</TITLE></HEAD>
<BODY TEXT="#000000" BGCOLOR="#FFFFFF"
  LINK="#0000FF" VLINK="#800080" ALINK="#FF00FF">
<TABLE WIDTH="100%">
<TR><TD ALIGN="right">
<TABLE><TR ALIGN="center">
  <TD><A HREF="advanced_index7.html" TARGET="display"><IMG SRC="left.gif"></A></TD>
  <TD><A HREF="advanced_index9.html" TARGET="display"><IMG SRC="right.gif"></A></TD>
</TR></TABLE></TD></TR>
<TR><TD ALIGN="left"><H1>Advanced Issues: More Versatile Control Structures</H1></TD></TR>
</TABLE>
<P><HR></P>
<TABLE><TR><TD WIDTH="25%">&nbsp;</TD><TD WIDTH="50%">

<P>
An old idea in the BETA community, and a good one, is to provide
"value" versions of the built-in control structures.  This has been
partially implemented in <B>gbeta</B> (but not in the <A HREF="http://www.mjolner.dk/" TARGET="_top">Mjolner BETA System</A> compiler).
Such versions are used in assignment context or in evaluation
context. 
</P>

<P>
An example of a "value" version of an <CODE>if</CODE>-imperative is:


<P>
  <TABLE BORDER=2 CELLPADDING=10 WIDTH=90% BGCOLOR="#FFFFFF">
    <TR><TD><PRE>(if b then 1 else a+b if) -&gt; putint</PRE></TD></TR>
  </TABLE>
</P>

This works like:


<P>
  <TABLE BORDER=2 CELLPADDING=10 WIDTH=90% BGCOLOR="#FFFFFF">
    <TR><TD><PRE>1 -&gt; putint</PRE></TD></TR>
  </TABLE>
</P>

if <CODE>b</CODE> evaluates to <CODE>true</CODE>, and it works like:


<P>
  <TABLE BORDER=2 CELLPADDING=10 WIDTH=90% BGCOLOR="#FFFFFF">
    <TR><TD><PRE>a+b -&gt; putint</PRE></TD></TR>
  </TABLE>
</P>

if <CODE>b</CODE> evaluates to <CODE>false</CODE>.

This is of course a similar semantics as that of the
<CODE>if</CODE>-statement in functional languages such as SML or
Haskell.  The assignment variant: 


<P>
  <TABLE BORDER=2 CELLPADDING=10 WIDTH=90% BGCOLOR="#FFFFFF">
    <TR><TD><PRE>x+y*y -&gt; (if b then putint else x if)</PRE></TD></TR>
  </TABLE>
</P>

resembles a (non-standard) usage of the ternary <CODE>"?:"</CODE>
operator in C, meaning: 


<P>
  <TABLE BORDER=2 CELLPADDING=10 WIDTH=90% BGCOLOR="#FFFFFF">
    <TR><TD><PRE>x+y*y -&gt; putint</PRE></TD></TR>
  </TABLE>
</P>

if <CODE>b</CODE> evaluates to <CODE>true</CODE>, and:


<P>
  <TABLE BORDER=2 CELLPADDING=10 WIDTH=90% BGCOLOR="#FFFFFF">
    <TR><TD><PRE>x+y*y -&gt; x</PRE></TD></TR>
  </TABLE>
</P>

if <CODE>b</CODE> evaluates to <CODE>false</CODE>.  Of course there is
a double-sided version of this, too:


<P>
  <TABLE BORDER=2 CELLPADDING=10 WIDTH=90% BGCOLOR="#FFFFFF">
    <TR><TD><PRE>x+y*y -&gt; (if b then putint; 3 else a; a+b if) -&gt; b</PRE></TD></TR>
  </TABLE>
</P>

The reason why this is not entirely trivial (perhaps it is ;-) is that
it is a surprisingly handy way to express a lot of things.
</P>

<P>
There should be a similar "value" version of the general
<CODE>if</CODE>-imperative, i.e. the control structure in BETA which
resembles <CODE>switch</CODE> in C (not too much, mind you!), but this
has not yet been implemented.  Similarly, there should be a "value"
version of the <CODE>for</CODE> imperative which would iterate the
transfer of values such that:


<P>
  <TABLE BORDER=2 CELLPADDING=10 WIDTH=90% BGCOLOR="#FFFFFF">
    <TR><TD><PRE>1 -&gt; (for 5 repeat i; i+1 for) -&gt; putint</PRE></TD></TR>
  </TABLE>
</P> 

would be the same as: 


<P>
  <TABLE BORDER=2 CELLPADDING=10 WIDTH=90% BGCOLOR="#FFFFFF">
    <TR><TD><PRE>1-&gt;i; 
i+1-&gt;i; 
i+1-&gt;i; 
i+1-&gt;i; 
i+1-&gt;i; 
i+1-&gt;putint</PRE></TD></TR>
  </TABLE>
</P> 
</P>

<P>
<A HREF="advanced_index9.html" TARGET="display">After this</A> slightly less serious section, we'll leave the
language <B>gbeta</B> and look at a few changes in the
<A HREF="index_modularization.html" TARGET="_top">modularization</A> system. 
</P>

<P>
</P>

<P>
</P>

</TD><TD WIDTH="20%">&nbsp;</TD></TR></TABLE>
<P><HR></P>
<SMALL>
  <I>
    <CENTER>
      <STRONG>Signed by: </STRONG>
      <A HREF="mailto:eernst@cs.auc.dk">eernst@cs.auc.dk</A>.
      Last Modified:  3-Jul-01
<BR>
    </CENTER>
  </I>
</SMALL>
</BODY>
</HTML>

